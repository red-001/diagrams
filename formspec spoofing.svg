<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" width="1289" height="1108" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (X11; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0&quot; version=&quot;6.7.3&quot; editor=&quot;www.draw.io&quot; type=&quot;github&quot;&gt;&lt;diagram name=&quot;Page-1&quot;&gt;7VpJc9s2FP41mp7q4SJS1DF2rPTQZjrjdNIcIRIWEYMEA4KW1F9fbFwBKbJMyvbEOkjkw8r3ve8toGb+Tbb7REGR/kUSiGeek+xm/seZ5y2WDv8Wgr0ShNFcCTYUJUrktoI79B/UQj1uU6EElr2OjBDMUNEXxiTPYcx6MkAp2fa73RPcX7UAG2gI7mKATelXlLBUSaPAaeV/QLRJ65VdR7esQfywoaTK9Xozz7+XH9WcgXou3b9MQUK2HZF/O/NvKCFMXWW7G4iFamu1qXGrA63NvinM2SkDPDXgEeAK1jsOMR96fU/4DHyDbK+VEv6oSN3weykh+8A7eGGxaxv51Ub8fiY0A1iqnmZlAWN+mYI8wSjf1CvwXalF1JBanKDHoWhNhxI+ttfP623VY3An5CnLMBe4/LJklDzAG4IJ5ZKc5FA8CsJ4IAIYbXJ+G3MFQi6/foSUIW4ZH3RDhpJELHO9TRGDdwWIxZpbToNmI131a0TELHDXEWk4PkGSQUb3vEvNHW0ZmjlzfbttzdCtu6RdE6wtCmjT3zQzt/DzC20BdmsIJ7KGe/AAk5nYYQgyoad8XRZycGMcZbXOUFkikr+bx1HzmL+gfbiBoUqYcMepbwllKdmQHODbVnotvSEUMzh9ncMdYv8K8VWg777plu+Qsb2OCqBihIvauf8kpND9DuqzJBWNa1+uQ4/Y6VENU4gBQ4/9EGBTlx76N0GSFDVuYXTldz7zqAeUvxgAwADdQKYnGWDQ7Oo0WObP561j4+2XFIrBkHL7lBd5Uoon6Pt1jg//kl1jjKCkrJ3BA9tpLcM9QJiOtWCwhvi6Ca81L3mA9f3VyvfHodcy6IHmhhZ6zYOp6LV8i/TSQUOZs84qnAtRbuEfo9x8OR3lRgiVRyhX88hJUFlgsC8bhrW8uyjHwnDFP+NwzHUGntFGMt8zSRaNwLHGhN8Sx14Jn8L5ZHyqn/A5fApsfPoKEFO0EavlRXVGdHJeDXPc4/7ORiTPkgyGYxDJLB3/KWFHyw4qdc7QzxGadALIFlkVyupgvW/6ZEQOSgFTUzCL/3uOoxPAa3K60cWSi8i306kLV2Txe82xyLPwemW5+xCC0xzhhXL5yO3ngeEQgRE9n5m8qxwAMMYN0ky8dS19oHa2MW2alGC1cvjnKUg+ocr1+lWub6PKcqoy11tMQxXvslyxJebLy/AnWPbxWwxTtxH5E00D1uJFwJo8w3PCATLTHUtYjhM/EtiWMk0ioFKAjk8TfWJCKYwZ5outDIR/4rT68B7PzcJwIhcW9BXdhJCuCwttLmyUaL80dP/UfNqNbPn0NwHgaQn0Gz5lDRYHWNIBb27Bbozo45ul0GfyapR7ErXqxcdnlevMXxAZ10BmcEKaQMZ9VtnWLsrTVaow2oIy/01yryoKUsI6W1vLdG+NG4FM6Fg7i/CLTcEEMNeWxYuSbS5+VyDJUC5LL50JCvXFIJfbk+/ktohrqh7P00yYFWIVUBSUFBQBBvH+aviuZqo0ckofPI8GxrI0jaU5Ver54OHJ4VnmYlbI+nSPJOIn4cFQ2UOcwvhBjLy3mIxhG1ltG/16mNfd/OtHBUumKgFlLt+rUoJb8oF18BUq4nqVxoTJFqoKnUPufEmRCr4VFkIMgfhRNTxSk+5ZKl/iOveUZNIkCIaiiRtAVtbbBHKWjFsUL03kAh2SFHxCNYfcKLedWBikqvrlBnTxk0xldeJMZiqrW3pnWt0odb6/sET+YYKcJx/EvyRaV52AMm20euSg5KB6fpq4dh4+sDx7LTs3v9W6DoZHWyrJNtJZMzHmNX8PtSCIpkqM/ehXhsgfhuKzITJmGhEiM3++s5+mvHwiduLb0TE93ZBt3ZrGtZiOP4Jjm5t58TskBiSeJdhMB4mZEN/oN5dvDJLmLc0ULPEuCYmZdL5DYkDi2yBxpoLEPyfcv8UIX5ddgxrdNU7lTw35w5lGC/j8tv2Trere/pHZv/0f&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><filter id="dropShadow"><feGaussianBlur in="SourceAlpha" stdDeviation="1.7" result="blur"/><feOffset in="blur" dx="3" dy="3" result="offsetBlur"/><feFlood flood-color="#3D4574" flood-opacity="0.4" result="offsetColor"/><feComposite in="offsetColor" in2="offsetBlur" operator="in" result="offsetBlur"/><feBlend in="SourceGraphic" in2="offsetBlur"/></filter></defs><g transform="translate(0.5,0.5)" filter="url(#dropShadow)"><g transform="translate(70.5,26.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="168" height="106" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 168px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 26px">Normal formspec handling</font><div><br /></div></div></div></foreignObject><text x="84" y="59" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(740.5,26.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="168" height="106" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 168px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 26px">faked  formspec submission</font><div><br /></div></div></div></foreignObject><text x="84" y="59" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 168 260 L 168 305 L 168.29 343.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 168.33 348.88 L 164.77 341.91 L 168.29 343.63 L 171.77 341.86 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="95" y="140" width="145" height="120" rx="18" ry="18" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(96.5,152.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="141" height="94" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 141px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;"><font style="font-size: 20px">The server sends a formspec to the client</font></div></div></foreignObject><text x="71" y="53" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 174 420 L 174 440 L 173 440 L 179.37 440" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 174.12 440 L 181.12 436.5 L 179.37 440 L 181.12 443.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="108" y="340" width="132" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(109.5,344.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="128" height="70" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 128px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;"><font style="font-size: 20px">The client displays the formspec</font></div></div></foreignObject><text x="64" y="41" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 173 500 L 173 560 L 173.3 613.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 173.33 618.88 L 169.79 611.9 L 173.3 613.63 L 176.79 611.86 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="113.33" y="440" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(114.5,440.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="58" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;"><font style="font-size: 25px">Wait for input</font></div></div></foreignObject><text x="58" y="35" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="83" y="620" width="182" height="210" rx="27.3" ry="27.3" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(84.5,682.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="84" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 178px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;">User input is send to the server and handled by the mod that sent the formspec</div></div></foreignObject><text x="89" y="51" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 815 440 L 815 583.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 815 588.88 L 811.5 581.88 L 815 583.63 L 818.5 581.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="720" y="320" width="190" height="120" rx="18" ry="18" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(721.5,337.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="186" height="84" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 186px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#FF0000;">The attacker sends a faked formspec submission to the server</div></div></foreignObject><text x="93" y="51" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 790 700 L 790 725 L 590 725 L 590 743.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 590 748.88 L 586.5 741.88 L 590 743.63 L 593.5 741.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 870 700 L 870 725 L 1060 725 L 1060 743.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1060 748.88 L 1056.5 741.88 L 1060 743.63 L 1063.5 741.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="750" y="590" width="160" height="110" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(751.5,613.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="156" height="63" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 156px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FF66;">Does the server handle formspecs correctly?</div></div></foreignObject><text x="78" y="41" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Does the server handle formspecs correctly?</text></switch></g><g transform="translate(575.5,749.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="29" height="20" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 18px">Yes</font></div></div></foreignObject><text x="15" y="16" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1048.5,749.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="23" height="20" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">No</div></div></foreignObject><text x="12" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">No</text></switch></g><rect x="480" y="770" width="280" height="190" rx="28.5" ry="28.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(481.5,800.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="276" height="128" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 276px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FF66;">The server detects that the user wasn't suppose to be able to submit that form and alerts the server owner/admins so they can deal with the attempt appropriately. </div></div></foreignObject><text x="138" y="73" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="920" y="770" width="280" height="210" rx="31.5" ry="31.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(921.5,789.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="276" height="171" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 276px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#FFFF66;">The code doesn't check if the user was able to summit the formspec in question and just assumes they are allowed to. This could lead end in anything from stolen items to a compromised server depending on which mod is attacked</div></div></foreignObject><text x="138" y="95" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 0 540 L 1281 538" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 0 300 L 1281 300" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(27.5,544.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="54" height="20" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 55px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;">Server</div></div></foreignObject><text x="27" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Server</text></switch></g><g transform="translate(27.5,274.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="54" height="20" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 55px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;">Server</div></div></foreignObject><text x="27" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Server</text></switch></g><g transform="translate(31.5,504.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="20" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 47px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;">Client</div></div></foreignObject><text x="23" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Client</text></switch></g><g transform="translate(26.5,304.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="20" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 47px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;">Client</div></div></foreignObject><text x="23" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Client</text></switch></g><path d="M 440 1100 L 440 0" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/></g></svg>