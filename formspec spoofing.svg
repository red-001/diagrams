<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1291" height="1110" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&quot; version=&quot;6.7.3&quot; editor=&quot;www.draw.io&quot; type=&quot;github&quot;&gt;&lt;diagram name=&quot;Page-1&quot;&gt;7VpJc9s2FP41mp7q4S7qGDtWemgznXE6aY4QCYuIQYIBQUvqry82roAV2SZle2IeRPIRG9/3vreAWvhX+f4TBWX2F0khXnhOul/4HxceP4KIn4TkoCXOMlCSLUWpkrmd4Ab9B7XQ0dIapbAaNGSEYIbKoTAhRQETNpABSslu2OyW4OGsJdhCQ3CTAGxKv6KUZUoah04n/wOibdbM7Dr6yQYkd1tK6kLPt/D8W3moxzloxtLtqwykZNcT+dcL/4oSwtRVvr+CWCi3UZvqt37gabtuCgt2SgdPdbgHuIbNiiPMu17eEj4CXyA7aKVEP2rSPPi9kpB94A28qNx3D/nVVpw/E5oDLFVP86qECb/MQJFiVGybGfiq1CSqSyNO0f1YtKFjCe87aOcNluoxuBfyjOWYC1x+WTFK7uAVwYRySUEKKF4FYTwSAYy2Bb9NuAIhl1/eQ8oQt4wP+kGO0lRMc7nLEIM3JUjEnDtOhHYhffVrRMQocN8TaTg+QZJDRg+8iX661JahqRPo211nhm7TJOubYGNRQJv+th25g59faAuwW0M0kzXcgjuYLsQKI5ALPRWbqpSdW+Oo6k2OqgqR4t08jppH8IL24YaGKmHKHae+JZRlZEsKgK876aX0hlCM4Ax1DveI/SvEF6G++6affIeMHXRUADUjXNSN/SchpW73oD4rUtOk8eU69IiVHtUwhRgwdD8MATZ16a5/EyRJ0eAWxRd+7wjiAVD+cgQAA3QLmR5khEG7qtNgCZ7PW8fG2y8ZFJ0h5fYpL4q0Em8w9OscH/4jmyYYQUlZO4NHttNZhvsAYXrWgsEG4ss2vDa85AHW99dr35+GXqtwAJobWegVhHPRa/UW6aWDhjLnJt87E+WW/jHKBav5KDdBqDxCuYZHToqqEoND1TKs491ZORZFa35MwzHXGXlGG8l8zyRZPAHHWhN+Sxx7JXyKgtn41Lzhc/gU2vj0FSCmaCNmK8r6CdHJeTXMcY/7OxuRPEsyGE1BJLN0/KeCPS07qNI5wzBHaNMJIJ/IqlBWB5tD2yYnslMGmBqCWfzfcxydAF6T043PllzEvp1Ofbhii99rt0Wehdcry93HEJzmCM+Uy8fuMA+MxghM6PnM5F3lAIAxbpBm4q1raUkEYtTONqbNkxKs1w4/HoPkI6pcb1jl+jaqrOYqc73lPFTxzssVW2K+Og9/wtUQv+U4dZuQP/E8YC1fBKzZMzwnGiEz37aEZTvxI4FdKdMmAioF6AV30SYhlMKEYT7Z2kD4J05rCO/x3CyKZnJh4VDRbQjpu7DI5sImifYrQ/ePzafd2JZPfxMAnpZAv+Fd1nD5AEt64AUW7KaIPr5ZCn0mr0a5J1GrmXx6VrlO8ILIuAYyox3SFDLus6qudlGerlaF0Q5UxW+Se3VZkgo22dpGpnsb3ApkQse6UYRfbAsmgLm2LF6U7ApxXoM0R4UsvXQmKNSXgEIuT36T2yGuqaY/TzNhXopZQFlSUlIEGMSHi/G3mrnSyDl9cBCPjGVlGku7qzTwweOdwyeZi1kh6909kopTyoOhsockg8md6HlrMRnDNvLGNob1MK+7+c+PGlZMVQLKXL7XlQS34h2b4CtUxPUqjQmTHVQVOofc+ZIhFXxrLIQYAnFSNTxSgx5YJj/iOreU5NIkCIbiETeAvGqWCeQoObcoXprICXokKfmAagy5UG47iTBIVfXLBejiJ53L6sSezFxWt/KeaHWT1Pn+0hL5xwlykX4Q/5LoXHUKqqzV6pGNkgfV89PEtffyoeXdG9lT81ut63C8taWSbCOdNRNjXvMPUAvDeK7E2I9/ZYj8cSh+MkTGSBNCZObPN/bdlJdPxE78OjqlpxuzrV/TuBbT8SdwbIGZF79DYkDiWYLNfJCYCfGV/nL5xiBpv9LMwRLvnJCYSec7JAYkvg0SZy5I/KeE+7cY4Zuya1Sju8au/KkhfzzSZAGf33Z/slXNu78y+9f/Aw==&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><filter id="dropShadow"><feGaussianBlur in="SourceAlpha" stdDeviation="1.7" result="blur"/><feOffset in="blur" dx="3" dy="3" result="offsetBlur"/><feFlood flood-color="#3D4574" flood-opacity="0.4" result="offsetColor"/><feComposite in="offsetColor" in2="offsetBlur" operator="in" result="offsetBlur"/><feBlend in="SourceGraphic" in2="offsetBlur"/></filter></defs><g transform="translate(0.5,0.5)" filter="url(#dropShadow)"><g transform="translate(70.5,27.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="168" height="105" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 168px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 26px">Normal formspec handling</font><div><br /></div></div></div></foreignObject><text x="84" y="59" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(740.5,27.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="168" height="105" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 168px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 26px">faked  formspec submission</font><div><br /></div></div></div></foreignObject><text x="84" y="59" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 168.29 260.29 L 168.33 343.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 168.33 348.88 L 164.83 341.88 L 168.33 343.63 L 171.83 341.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="95" y="140" width="145" height="120" rx="18" ry="18" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(95.5,151.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="140" height="94" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 140px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;"><font style="font-size: 20px">The server sends a formspec to the client</font></div></div></foreignObject><text x="70" y="53" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 174 420.29 L 174 440.29 L 174 433.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 174 438.88 L 170.5 431.88 L 174 433.63 L 177.5 431.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="108" y="340" width="132" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(108.5,343.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="127" height="70" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 127px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;"><font style="font-size: 20px">The client displays the formspec</font></div></div></foreignObject><text x="64" y="41" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 174 500.29 L 174 560.29 L 173.4 613.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 173.35 618.88 L 169.92 611.84 L 173.4 613.63 L 176.92 611.92 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="113.33" y="440" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(113.5,439.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="58" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 115px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;"><font style="font-size: 25px">Wait for input</font></div></div></foreignObject><text x="58" y="35" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="83" y="620" width="182" height="210" rx="27.3" ry="27.3" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(83.5,671.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="177" height="103" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;">User input is send to the server and handled by the mod that sent the formspec</div></div></foreignObject><text x="89" y="61" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 814 440.29 L 814 514.57 L 814.92 583.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 814.99 588.88 L 811.39 581.93 L 814.92 583.63 L 818.39 581.84 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="720" y="320" width="190" height="120" rx="18" ry="18" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(720.5,337.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="185" height="82" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 185px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#FF0000;">The attacker sends a faked formsoec submission to the server</div></div></foreignObject><text x="93" y="50" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 791.14 700.29 L 791.14 726 L 591.14 726 L 591.14 743.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 591.14 748.88 L 587.64 741.88 L 591.14 743.63 L 594.64 741.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 871.14 700.29 L 871.14 726 L 1059.71 726 L 1059.92 743.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1059.99 748.88 L 1056.4 741.92 L 1059.92 743.63 L 1063.4 741.84 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="750" y="590" width="160" height="110" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(750.5,602.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="155" height="82" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FF66;">Does the server handle formspecs correctly?</div></div></foreignObject><text x="78" y="50" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Does the server handle formspecs correctly?</text></switch></g><g transform="translate(574.5,750.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="19" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><font style="font-size: 18px">Yes</font></div></div></foreignObject><text x="15" y="16" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1047.5,750.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="19" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">No</div></div></foreignObject><text x="12" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">No</text></switch></g><rect x="480" y="770" width="280" height="190" rx="28.5" ry="28.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(480.5,790.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="275" height="145" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 275px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FF66;">The server detects that the user wasn't suppose to be able to submit that form and alerts the server owner/admins so they can deal with the attempt appropriately. </div></div></foreignObject><text x="138" y="82" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="920" y="770" width="280" height="210" rx="31.5" ry="31.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(920.5,779.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="275" height="187" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 275px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#FFFF66;">The code doesn't check if the user was able to summit the formspec in question and just assumes they are allowed to. This could lead end in anything from stolen items to a compromised server depending on which mod is attacked</div></div></foreignObject><text x="138" y="103" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 0 540 L 1281 538" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 0 300 L 1281 300" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(24.5,545.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="60" height="19" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 60px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;">Server</div></div></foreignObject><text x="30" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Server</text></switch></g><g transform="translate(24.5,275.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="60" height="19" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 60px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#33FF33;">Server</div></div></foreignObject><text x="30" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Server</text></switch></g><g transform="translate(28.5,505.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="52" height="19" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 54px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;">Client</div></div></foreignObject><text x="26" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Client</text></switch></g><g transform="translate(23.5,305.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="52" height="19" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 18px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 54px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#66FFFF;">Client</div></div></foreignObject><text x="26" y="19" fill="#000000" text-anchor="middle" font-size="18px" font-family="Helvetica">Client</text></switch></g><path d="M 440 1100 L 440 0" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/></g></svg>